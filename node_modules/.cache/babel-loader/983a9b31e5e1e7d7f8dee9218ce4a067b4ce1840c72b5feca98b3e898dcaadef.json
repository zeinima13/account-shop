{"ast":null,"code":"import \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array.reduce.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.reduce.js\";\nimport { getCurrentInstance, ref } from 'vue';\nimport { getKeysMap, getRowIdentity, toggleRowStatus } from '../util.mjs';\nfunction useExpand(watcherData) {\n  var instance = getCurrentInstance();\n  var defaultExpandAll = ref(false);\n  var expandRows = ref([]);\n  var updateExpandRows = function updateExpandRows() {\n    var data = watcherData.data.value || [];\n    var rowKey = watcherData.rowKey.value;\n    if (defaultExpandAll.value) {\n      expandRows.value = data.slice();\n    } else if (rowKey) {\n      var expandRowsMap = getKeysMap(expandRows.value, rowKey);\n      expandRows.value = data.reduce(function (prev, row) {\n        var rowId = getRowIdentity(row, rowKey);\n        var rowInfo = expandRowsMap[rowId];\n        if (rowInfo) {\n          prev.push(row);\n        }\n        return prev;\n      }, []);\n    } else {\n      expandRows.value = [];\n    }\n  };\n  var toggleRowExpansion = function toggleRowExpansion(row, expanded) {\n    var changed = toggleRowStatus(expandRows.value, row, expanded);\n    if (changed) {\n      instance.emit(\"expand-change\", row, expandRows.value.slice());\n    }\n  };\n  var setExpandRowKeys = function setExpandRowKeys(rowKeys) {\n    instance.store.assertRowKey();\n    var data = watcherData.data.value || [];\n    var rowKey = watcherData.rowKey.value;\n    var keysMap = getKeysMap(data, rowKey);\n    expandRows.value = rowKeys.reduce(function (prev, cur) {\n      var info = keysMap[cur];\n      if (info) {\n        prev.push(info.row);\n      }\n      return prev;\n    }, []);\n  };\n  var isRowExpanded = function isRowExpanded(row) {\n    var rowKey = watcherData.rowKey.value;\n    if (rowKey) {\n      var expandMap = getKeysMap(expandRows.value, rowKey);\n      return !!expandMap[getRowIdentity(row, rowKey)];\n    }\n    return expandRows.value.includes(row);\n  };\n  return {\n    updateExpandRows: updateExpandRows,\n    toggleRowExpansion: toggleRowExpansion,\n    setExpandRowKeys: setExpandRowKeys,\n    isRowExpanded: isRowExpanded,\n    states: {\n      expandRows: expandRows,\n      defaultExpandAll: defaultExpandAll\n    }\n  };\n}\nexport { useExpand as default };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}