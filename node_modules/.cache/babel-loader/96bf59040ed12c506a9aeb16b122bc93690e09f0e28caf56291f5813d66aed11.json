{"ast":null,"code":"import \"core-js/modules/es.array.concat.js\";\nimport { onMounted, watchEffect, onBeforeUnmount } from 'vue';\nimport { addUnit } from '../../utils/dom/style.mjs';\nvar useDraggable = function useDraggable(targetRef, dragRef, draggable, overflow) {\n  var transform = {\n    offsetX: 0,\n    offsetY: 0\n  };\n  var onMousedown = function onMousedown(e) {\n    var downX = e.clientX;\n    var downY = e.clientY;\n    var _transform = transform,\n      offsetX = _transform.offsetX,\n      offsetY = _transform.offsetY;\n    var targetRect = targetRef.value.getBoundingClientRect();\n    var targetLeft = targetRect.left;\n    var targetTop = targetRect.top;\n    var targetWidth = targetRect.width;\n    var targetHeight = targetRect.height;\n    var clientWidth = document.documentElement.clientWidth;\n    var clientHeight = document.documentElement.clientHeight;\n    var minLeft = -targetLeft + offsetX;\n    var minTop = -targetTop + offsetY;\n    var maxLeft = clientWidth - targetLeft - targetWidth + offsetX;\n    var maxTop = clientHeight - targetTop - targetHeight + offsetY;\n    var onMousemove = function onMousemove(e2) {\n      var moveX = offsetX + e2.clientX - downX;\n      var moveY = offsetY + e2.clientY - downY;\n      if (!(overflow == null ? void 0 : overflow.value)) {\n        moveX = Math.min(Math.max(moveX, minLeft), maxLeft);\n        moveY = Math.min(Math.max(moveY, minTop), maxTop);\n      }\n      transform = {\n        offsetX: moveX,\n        offsetY: moveY\n      };\n      if (targetRef.value) {\n        targetRef.value.style.transform = \"translate(\".concat(addUnit(moveX), \", \").concat(addUnit(moveY), \")\");\n      }\n    };\n    var _onMouseup = function onMouseup() {\n      document.removeEventListener(\"mousemove\", onMousemove);\n      document.removeEventListener(\"mouseup\", _onMouseup);\n    };\n    document.addEventListener(\"mousemove\", onMousemove);\n    document.addEventListener(\"mouseup\", _onMouseup);\n  };\n  var onDraggable = function onDraggable() {\n    if (dragRef.value && targetRef.value) {\n      dragRef.value.addEventListener(\"mousedown\", onMousedown);\n    }\n  };\n  var offDraggable = function offDraggable() {\n    if (dragRef.value && targetRef.value) {\n      dragRef.value.removeEventListener(\"mousedown\", onMousedown);\n    }\n  };\n  var resetPosition = function resetPosition() {\n    transform = {\n      offsetX: 0,\n      offsetY: 0\n    };\n    if (targetRef.value) {\n      targetRef.value.style.transform = \"none\";\n    }\n  };\n  onMounted(function () {\n    watchEffect(function () {\n      if (draggable.value) {\n        onDraggable();\n      } else {\n        offDraggable();\n      }\n    });\n  });\n  onBeforeUnmount(function () {\n    offDraggable();\n  });\n  return {\n    resetPosition: resetPosition\n  };\n};\nexport { useDraggable };","map":{"version":3,"names":["useDraggable","targetRef","dragRef","draggable","overflow","transform","offsetX","offsetY","onMousedown","e","downX","clientX","downY","clientY","_transform","targetRect","value","getBoundingClientRect","targetLeft","left","targetTop","top","targetWidth","width","targetHeight","height","clientWidth","document","documentElement","clientHeight","minLeft","minTop","maxLeft","maxTop","onMousemove","e2","moveX","moveY","Math","min","max","style","concat","addUnit","onMouseup","removeEventListener","addEventListener","onDraggable","offDraggable","resetPosition","onMounted","watchEffect","onBeforeUnmount"],"sources":["../../../../../packages/hooks/use-draggable/index.ts"],"sourcesContent":["import { onBeforeUnmount, onMounted, watchEffect } from 'vue'\nimport { addUnit } from '@element-plus/utils'\nimport type { ComputedRef, Ref } from 'vue'\n\nexport const useDraggable = (\n  targetRef: Ref<HTMLElement | undefined>,\n  dragRef: Ref<HTMLElement | undefined>,\n  draggable: ComputedRef<boolean>,\n  overflow?: ComputedRef<boolean>\n) => {\n  let transform = {\n    offsetX: 0,\n    offsetY: 0,\n  }\n\n  const onMousedown = (e: MouseEvent) => {\n    const downX = e.clientX\n    const downY = e.clientY\n    const { offsetX, offsetY } = transform\n\n    const targetRect = targetRef.value!.getBoundingClientRect()\n    const targetLeft = targetRect.left\n    const targetTop = targetRect.top\n    const targetWidth = targetRect.width\n    const targetHeight = targetRect.height\n\n    const clientWidth = document.documentElement.clientWidth\n    const clientHeight = document.documentElement.clientHeight\n\n    const minLeft = -targetLeft + offsetX\n    const minTop = -targetTop + offsetY\n    const maxLeft = clientWidth - targetLeft - targetWidth + offsetX\n    const maxTop = clientHeight - targetTop - targetHeight + offsetY\n\n    const onMousemove = (e: MouseEvent) => {\n      let moveX = offsetX + e.clientX - downX\n      let moveY = offsetY + e.clientY - downY\n\n      if (!overflow?.value) {\n        moveX = Math.min(Math.max(moveX, minLeft), maxLeft)\n        moveY = Math.min(Math.max(moveY, minTop), maxTop)\n      }\n\n      transform = {\n        offsetX: moveX,\n        offsetY: moveY,\n      }\n\n      if (targetRef.value) {\n        targetRef.value.style.transform = `translate(${addUnit(\n          moveX\n        )}, ${addUnit(moveY)})`\n      }\n    }\n\n    const onMouseup = () => {\n      document.removeEventListener('mousemove', onMousemove)\n      document.removeEventListener('mouseup', onMouseup)\n    }\n\n    document.addEventListener('mousemove', onMousemove)\n    document.addEventListener('mouseup', onMouseup)\n  }\n\n  const onDraggable = () => {\n    if (dragRef.value && targetRef.value) {\n      dragRef.value.addEventListener('mousedown', onMousedown)\n    }\n  }\n\n  const offDraggable = () => {\n    if (dragRef.value && targetRef.value) {\n      dragRef.value.removeEventListener('mousedown', onMousedown)\n    }\n  }\n\n  const resetPosition = () => {\n    transform = {\n      offsetX: 0,\n      offsetY: 0,\n    }\n    if (targetRef.value) {\n      targetRef.value.style.transform = 'none'\n    }\n  }\n\n  onMounted(() => {\n    watchEffect(() => {\n      if (draggable.value) {\n        onDraggable()\n      } else {\n        offDraggable()\n      }\n    })\n  })\n\n  onBeforeUnmount(() => {\n    offDraggable()\n  })\n\n  return {\n    resetPosition,\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}