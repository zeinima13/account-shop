{"ast":null,"code":"import \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport { isRef, ref } from 'vue';\nimport { Loading } from './service.mjs';\nimport { isObject, hyphenate, isString } from '@vue/shared';\nvar INSTANCE_KEY = Symbol(\"ElLoading\");\nvar createInstance = function createInstance(el, binding) {\n  var _a, _b, _c, _d;\n  var vm = binding.instance;\n  var getBindingProp = function getBindingProp(key) {\n    return isObject(binding.value) ? binding.value[key] : void 0;\n  };\n  var resolveExpression = function resolveExpression(key) {\n    var data = isString(key) && (vm == null ? void 0 : vm[key]) || key;\n    if (data) return ref(data);else return data;\n  };\n  var getProp = function getProp(name) {\n    return resolveExpression(getBindingProp(name) || el.getAttribute(\"element-loading-\".concat(hyphenate(name))));\n  };\n  var fullscreen = (_a = getBindingProp(\"fullscreen\")) != null ? _a : binding.modifiers.fullscreen;\n  var options = {\n    text: getProp(\"text\"),\n    svg: getProp(\"svg\"),\n    svgViewBox: getProp(\"svgViewBox\"),\n    spinner: getProp(\"spinner\"),\n    background: getProp(\"background\"),\n    customClass: getProp(\"customClass\"),\n    fullscreen: fullscreen,\n    target: (_b = getBindingProp(\"target\")) != null ? _b : fullscreen ? void 0 : el,\n    body: (_c = getBindingProp(\"body\")) != null ? _c : binding.modifiers.body,\n    lock: (_d = getBindingProp(\"lock\")) != null ? _d : binding.modifiers.lock\n  };\n  el[INSTANCE_KEY] = {\n    options: options,\n    instance: Loading(options)\n  };\n};\nvar updateOptions = function updateOptions(newOptions, originalOptions) {\n  for (var _i = 0, _Object$keys = Object.keys(originalOptions); _i < _Object$keys.length; _i++) {\n    var key = _Object$keys[_i];\n    if (isRef(originalOptions[key])) originalOptions[key].value = newOptions[key];\n  }\n};\nvar vLoading = {\n  mounted: function mounted(el, binding) {\n    if (binding.value) {\n      createInstance(el, binding);\n    }\n  },\n  updated: function updated(el, binding) {\n    var instance = el[INSTANCE_KEY];\n    if (binding.oldValue !== binding.value) {\n      if (binding.value && !binding.oldValue) {\n        createInstance(el, binding);\n      } else if (binding.value && binding.oldValue) {\n        if (isObject(binding.value)) updateOptions(binding.value, instance.options);\n      } else {\n        instance == null ? void 0 : instance.instance.close();\n      }\n    }\n  },\n  unmounted: function unmounted(el) {\n    var _a;\n    (_a = el[INSTANCE_KEY]) == null ? void 0 : _a.instance.close();\n    el[INSTANCE_KEY] = null;\n  }\n};\nexport { vLoading };","map":{"version":3,"names":["INSTANCE_KEY","Symbol","createInstance","el","binding","_a","_b","_c","_d","vm","instance","getBindingProp","key","isObject","value","resolveExpression","data","isString","ref","getProp","name","getAttribute","concat","hyphenate","fullscreen","modifiers","options","text","svg","svgViewBox","spinner","background","customClass","target","body","lock","Loading","updateOptions","newOptions","originalOptions","_i","_Object$keys","Object","keys","length","isRef","vLoading","mounted","updated","oldValue","close","unmounted"],"sources":["../../../../../../packages/components/loading/src/directive.ts"],"sourcesContent":["// @ts-nocheck\nimport { isRef, ref } from 'vue'\nimport { hyphenate, isObject, isString } from '@element-plus/utils'\nimport { Loading } from './service'\nimport type { Directive, DirectiveBinding, UnwrapRef } from 'vue'\nimport type { LoadingOptions } from './types'\nimport type { LoadingInstance } from './loading'\n\nconst INSTANCE_KEY = Symbol('ElLoading')\n\nexport type LoadingBinding = boolean | UnwrapRef<LoadingOptions>\nexport interface ElementLoading extends HTMLElement {\n  [INSTANCE_KEY]?: {\n    instance: LoadingInstance\n    options: LoadingOptions\n  }\n}\n\nconst createInstance = (\n  el: ElementLoading,\n  binding: DirectiveBinding<LoadingBinding>\n) => {\n  const vm = binding.instance\n\n  const getBindingProp = <K extends keyof LoadingOptions>(\n    key: K\n  ): LoadingOptions[K] =>\n    isObject(binding.value) ? binding.value[key] : undefined\n\n  const resolveExpression = (key: any) => {\n    const data = (isString(key) && vm?.[key]) || key\n    if (data) return ref(data)\n    else return data\n  }\n\n  const getProp = <K extends keyof LoadingOptions>(name: K) =>\n    resolveExpression(\n      getBindingProp(name) ||\n        el.getAttribute(`element-loading-${hyphenate(name)}`)\n    )\n\n  const fullscreen =\n    getBindingProp('fullscreen') ?? binding.modifiers.fullscreen\n\n  const options: LoadingOptions = {\n    text: getProp('text'),\n    svg: getProp('svg'),\n    svgViewBox: getProp('svgViewBox'),\n    spinner: getProp('spinner'),\n    background: getProp('background'),\n    customClass: getProp('customClass'),\n    fullscreen,\n    target: getBindingProp('target') ?? (fullscreen ? undefined : el),\n    body: getBindingProp('body') ?? binding.modifiers.body,\n    lock: getBindingProp('lock') ?? binding.modifiers.lock,\n  }\n  el[INSTANCE_KEY] = {\n    options,\n    instance: Loading(options),\n  }\n}\n\nconst updateOptions = (\n  newOptions: UnwrapRef<LoadingOptions>,\n  originalOptions: LoadingOptions\n) => {\n  for (const key of Object.keys(originalOptions)) {\n    if (isRef(originalOptions[key]))\n      originalOptions[key].value = newOptions[key]\n  }\n}\n\nexport const vLoading: Directive<ElementLoading, LoadingBinding> = {\n  mounted(el, binding) {\n    if (binding.value) {\n      createInstance(el, binding)\n    }\n  },\n  updated(el, binding) {\n    const instance = el[INSTANCE_KEY]\n    if (binding.oldValue !== binding.value) {\n      if (binding.value && !binding.oldValue) {\n        createInstance(el, binding)\n      } else if (binding.value && binding.oldValue) {\n        if (isObject(binding.value))\n          updateOptions(binding.value, instance!.options)\n      } else {\n        instance?.instance.close()\n      }\n    }\n  },\n  unmounted(el) {\n    el[INSTANCE_KEY]?.instance.close()\n    el[INSTANCE_KEY] = null\n  },\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}