{"ast":null,"code":"import \"core-js/modules/es.array.index-of.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.string.ends-with.js\";\nimport \"core-js/modules/es.string.starts-with.js\";\nfunction useCursor(input) {\n  var selectionInfo;\n  function recordCursor() {\n    if (input.value == void 0) return;\n    var _input$value = input.value,\n      selectionStart = _input$value.selectionStart,\n      selectionEnd = _input$value.selectionEnd,\n      value = _input$value.value;\n    if (selectionStart == null || selectionEnd == null) return;\n    var beforeTxt = value.slice(0, Math.max(0, selectionStart));\n    var afterTxt = value.slice(Math.max(0, selectionEnd));\n    selectionInfo = {\n      selectionStart: selectionStart,\n      selectionEnd: selectionEnd,\n      value: value,\n      beforeTxt: beforeTxt,\n      afterTxt: afterTxt\n    };\n  }\n  function setCursor() {\n    if (input.value == void 0 || selectionInfo == void 0) return;\n    var value = input.value.value;\n    var _selectionInfo = selectionInfo,\n      beforeTxt = _selectionInfo.beforeTxt,\n      afterTxt = _selectionInfo.afterTxt,\n      selectionStart = _selectionInfo.selectionStart;\n    if (beforeTxt == void 0 || afterTxt == void 0 || selectionStart == void 0) return;\n    var startPos = value.length;\n    if (value.endsWith(afterTxt)) {\n      startPos = value.length - afterTxt.length;\n    } else if (value.startsWith(beforeTxt)) {\n      startPos = beforeTxt.length;\n    } else {\n      var beforeLastChar = beforeTxt[selectionStart - 1];\n      var newIndex = value.indexOf(beforeLastChar, selectionStart - 1);\n      if (newIndex !== -1) {\n        startPos = newIndex + 1;\n      }\n    }\n    input.value.setSelectionRange(startPos, startPos);\n  }\n  return [recordCursor, setCursor];\n}\nexport { useCursor };","map":{"version":3,"names":["useCursor","input","selectionInfo","recordCursor","value","_input$value","selectionStart","selectionEnd","beforeTxt","slice","Math","max","afterTxt","setCursor","_selectionInfo","startPos","length","endsWith","startsWith","beforeLastChar","newIndex","indexOf","setSelectionRange"],"sources":["../../../../../packages/hooks/use-cursor/index.ts"],"sourcesContent":["import type { ShallowRef } from 'vue'\n\ninterface SelectionInfo {\n  selectionStart?: number\n  selectionEnd?: number\n  value?: string\n  beforeTxt?: string\n  afterTxt?: string\n}\n\n// Keep input cursor in the correct position when we use formatter.\nexport function useCursor(\n  input: ShallowRef<HTMLInputElement | undefined>\n): [() => void, () => void] {\n  let selectionInfo: SelectionInfo\n  function recordCursor() {\n    if (input.value == undefined) return\n\n    const { selectionStart, selectionEnd, value } = input.value\n\n    if (selectionStart == null || selectionEnd == null) return\n\n    const beforeTxt = value.slice(0, Math.max(0, selectionStart))\n    const afterTxt = value.slice(Math.max(0, selectionEnd))\n\n    selectionInfo = {\n      selectionStart,\n      selectionEnd,\n      value,\n      beforeTxt,\n      afterTxt,\n    }\n  }\n  function setCursor() {\n    if (input.value == undefined || selectionInfo == undefined) return\n\n    const { value } = input.value\n    const { beforeTxt, afterTxt, selectionStart } = selectionInfo\n\n    if (\n      beforeTxt == undefined ||\n      afterTxt == undefined ||\n      selectionStart == undefined\n    )\n      return\n\n    let startPos = value.length\n\n    if (value.endsWith(afterTxt)) {\n      startPos = value.length - afterTxt.length\n    } else if (value.startsWith(beforeTxt)) {\n      startPos = beforeTxt.length\n    } else {\n      const beforeLastChar = beforeTxt[selectionStart - 1]\n      const newIndex = value.indexOf(beforeLastChar, selectionStart - 1)\n      if (newIndex !== -1) {\n        startPos = newIndex + 1\n      }\n    }\n\n    input.value.setSelectionRange(startPos, startPos)\n  }\n\n  return [recordCursor, setCursor]\n}\n"],"mappings":";;;;AAAO,SAASA,SAASA,CAACC,KAAK,EAAE;EAC/B,IAAIC,aAAa;EACjB,SAASC,YAAYA,CAAA,EAAG;IACtB,IAAIF,KAAK,CAACG,KAAK,IAAI,KAAK,CAAC,EACvB;IACF,IAAAC,YAAA,GAAgDJ,KAAK,CAACG,KAAK;MAAnDE,cAAc,GAAAD,YAAA,CAAdC,cAAc;MAAEC,YAAY,GAAAF,YAAA,CAAZE,YAAY;MAAEH,KAAK,GAAAC,YAAA,CAALD,KAAK;IAC3C,IAAIE,cAAc,IAAI,IAAI,IAAIC,YAAY,IAAI,IAAI,EAChD;IACF,IAAMC,SAAS,GAAGJ,KAAK,CAACK,KAAK,CAAC,CAAC,EAAEC,IAAI,CAACC,GAAG,CAAC,CAAC,EAAEL,cAAc,CAAC,CAAC;IAC7D,IAAMM,QAAQ,GAAGR,KAAK,CAACK,KAAK,CAACC,IAAI,CAACC,GAAG,CAAC,CAAC,EAAEJ,YAAY,CAAC,CAAC;IACvDL,aAAa,GAAG;MACdI,cAAc,EAAdA,cAAc;MACdC,YAAY,EAAZA,YAAY;MACZH,KAAK,EAALA,KAAK;MACLI,SAAS,EAATA,SAAS;MACTI,QAAQ,EAARA;IACN,CAAK;EACL;EACE,SAASC,SAASA,CAAA,EAAG;IACnB,IAAIZ,KAAK,CAACG,KAAK,IAAI,KAAK,CAAC,IAAIF,aAAa,IAAI,KAAK,CAAC,EAClD;IACF,IAAQE,KAAK,GAAKH,KAAK,CAACG,KAAK,CAArBA,KAAK;IACb,IAAAU,cAAA,GAAgDZ,aAAa;MAArDM,SAAS,GAAAM,cAAA,CAATN,SAAS;MAAEI,QAAQ,GAAAE,cAAA,CAARF,QAAQ;MAAEN,cAAc,GAAAQ,cAAA,CAAdR,cAAc;IAC3C,IAAIE,SAAS,IAAI,KAAK,CAAC,IAAII,QAAQ,IAAI,KAAK,CAAC,IAAIN,cAAc,IAAI,KAAK,CAAC,EACvE;IACF,IAAIS,QAAQ,GAAGX,KAAK,CAACY,MAAM;IAC3B,IAAIZ,KAAK,CAACa,QAAQ,CAACL,QAAQ,CAAC,EAAE;MAC5BG,QAAQ,GAAGX,KAAK,CAACY,MAAM,GAAGJ,QAAQ,CAACI,MAAM;IAC/C,CAAK,MAAM,IAAIZ,KAAK,CAACc,UAAU,CAACV,SAAS,CAAC,EAAE;MACtCO,QAAQ,GAAGP,SAAS,CAACQ,MAAM;IACjC,CAAK,MAAM;MACL,IAAMG,cAAc,GAAGX,SAAS,CAACF,cAAc,GAAG,CAAC,CAAC;MACpD,IAAMc,QAAQ,GAAGhB,KAAK,CAACiB,OAAO,CAACF,cAAc,EAAEb,cAAc,GAAG,CAAC,CAAC;MAClE,IAAIc,QAAQ,KAAK,CAAC,CAAC,EAAE;QACnBL,QAAQ,GAAGK,QAAQ,GAAG,CAAC;MAC/B;IACA;IACInB,KAAK,CAACG,KAAK,CAACkB,iBAAiB,CAACP,QAAQ,EAAEA,QAAQ,CAAC;EACrD;EACE,OAAO,CAACZ,YAAY,EAAEU,SAAS,CAAC;AAClC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}