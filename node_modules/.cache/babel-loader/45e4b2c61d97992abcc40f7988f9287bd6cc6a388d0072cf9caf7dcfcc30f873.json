{"ast":null,"code":"import \"core-js/modules/es.array.find-index.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport { inject, getCurrentInstance, ref, unref, onMounted, reactive, onUnmounted } from 'vue';\nimport { carouselContextKey, CAROUSEL_ITEM_NAME } from './constants.mjs';\nimport { debugWarn } from '../../../utils/error.mjs';\nimport { isUndefined } from '../../../utils/types.mjs';\nvar useCarouselItem = function useCarouselItem(props) {\n  var carouselContext = inject(carouselContextKey);\n  var instance = getCurrentInstance();\n  if (!carouselContext) {\n    debugWarn(CAROUSEL_ITEM_NAME, \"usage: <el-carousel></el-carousel-item></el-carousel>\");\n  }\n  if (!instance) {\n    debugWarn(CAROUSEL_ITEM_NAME, \"compositional hook can only be invoked inside setups\");\n  }\n  var carouselItemRef = ref();\n  var hover = ref(false);\n  var translate = ref(0);\n  var scale = ref(1);\n  var active = ref(false);\n  var ready = ref(false);\n  var inStage = ref(false);\n  var animating = ref(false);\n  var isCardType = carouselContext.isCardType,\n    isVertical = carouselContext.isVertical,\n    cardScale = carouselContext.cardScale;\n  function processIndex(index, activeIndex, length) {\n    var lastItemIndex = length - 1;\n    var prevItemIndex = activeIndex - 1;\n    var nextItemIndex = activeIndex + 1;\n    var halfItemIndex = length / 2;\n    if (activeIndex === 0 && index === lastItemIndex) {\n      return -1;\n    } else if (activeIndex === lastItemIndex && index === 0) {\n      return length;\n    } else if (index < prevItemIndex && activeIndex - index >= halfItemIndex) {\n      return length + 1;\n    } else if (index > nextItemIndex && index - activeIndex >= halfItemIndex) {\n      return -2;\n    }\n    return index;\n  }\n  function calcCardTranslate(index, activeIndex) {\n    var _a, _b;\n    var parentWidth = unref(isVertical) ? ((_a = carouselContext.root.value) == null ? void 0 : _a.offsetHeight) || 0 : ((_b = carouselContext.root.value) == null ? void 0 : _b.offsetWidth) || 0;\n    if (inStage.value) {\n      return parentWidth * ((2 - cardScale) * (index - activeIndex) + 1) / 4;\n    } else if (index < activeIndex) {\n      return -(1 + cardScale) * parentWidth / 4;\n    } else {\n      return (3 + cardScale) * parentWidth / 4;\n    }\n  }\n  function calcTranslate(index, activeIndex, isVertical2) {\n    var rootEl = carouselContext.root.value;\n    if (!rootEl) return 0;\n    var distance = (isVertical2 ? rootEl.offsetHeight : rootEl.offsetWidth) || 0;\n    return distance * (index - activeIndex);\n  }\n  var translateItem = function translateItem(index, activeIndex, oldIndex) {\n    var _a;\n    var _isCardType = unref(isCardType);\n    var carouselItemLength = (_a = carouselContext.items.value.length) != null ? _a : Number.NaN;\n    var isActive = index === activeIndex;\n    if (!_isCardType && !isUndefined(oldIndex)) {\n      animating.value = isActive || index === oldIndex;\n    }\n    if (!isActive && carouselItemLength > 2 && carouselContext.loop) {\n      index = processIndex(index, activeIndex, carouselItemLength);\n    }\n    var _isVertical = unref(isVertical);\n    active.value = isActive;\n    if (_isCardType) {\n      inStage.value = Math.round(Math.abs(index - activeIndex)) <= 1;\n      translate.value = calcCardTranslate(index, activeIndex);\n      scale.value = unref(active) ? 1 : cardScale;\n    } else {\n      translate.value = calcTranslate(index, activeIndex, _isVertical);\n    }\n    ready.value = true;\n    if (isActive && carouselItemRef.value) {\n      carouselContext.setContainerHeight(carouselItemRef.value.offsetHeight);\n    }\n  };\n  function handleItemClick() {\n    if (carouselContext && unref(isCardType)) {\n      var index = carouselContext.items.value.findIndex(function (_ref) {\n        var uid = _ref.uid;\n        return uid === instance.uid;\n      });\n      carouselContext.setActiveItem(index);\n    }\n  }\n  onMounted(function () {\n    carouselContext.addItem({\n      props: props,\n      states: reactive({\n        hover: hover,\n        translate: translate,\n        scale: scale,\n        active: active,\n        ready: ready,\n        inStage: inStage,\n        animating: animating\n      }),\n      uid: instance.uid,\n      translateItem: translateItem\n    });\n  });\n  onUnmounted(function () {\n    carouselContext.removeItem(instance.uid);\n  });\n  return {\n    carouselItemRef: carouselItemRef,\n    active: active,\n    animating: animating,\n    hover: hover,\n    inStage: inStage,\n    isVertical: isVertical,\n    translate: translate,\n    isCardType: isCardType,\n    scale: scale,\n    ready: ready,\n    handleItemClick: handleItemClick\n  };\n};\nexport { useCarouselItem };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}