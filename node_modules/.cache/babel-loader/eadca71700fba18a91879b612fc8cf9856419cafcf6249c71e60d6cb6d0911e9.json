{"ast":null,"code":"import _objectSpread from \"C:/Users/ASUS/CascadeProjects/account-shop/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.split.js\";\nimport \"core-js/modules/es.string.starts-with.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.find.js\";\nimport \"core-js/modules/web.timers.js\";\nimport { defineComponent, computed, ref, openBlock, createElementBlock, normalizeClass, unref, createVNode, mergeProps, createSlots, renderList, withCtx, renderSlot, normalizeProps, guardReactiveProps, createElementVNode, normalizeStyle, withModifiers, nextTick } from 'vue';\nimport { pick } from 'lodash-unified';\nimport { ElInput } from '../../input/index.mjs';\nimport { ElTooltip } from '../../tooltip/index.mjs';\nimport { mentionProps, mentionEmits } from './mention.mjs';\nimport { getCursorPosition, getMentionCtx } from './helper.mjs';\nimport ElMentionDropdown from './mention-dropdown2.mjs';\nimport _export_sfc from '../../../_virtual/plugin-vue_export-helper.mjs';\nimport { inputProps } from '../../input/src/input.mjs';\nimport { useNamespace } from '../../../hooks/use-namespace/index.mjs';\nimport { useFormDisabled } from '../../form/src/hooks/use-form-common-props.mjs';\nimport { useId } from '../../../hooks/use-id/index.mjs';\nimport { useFocusController } from '../../../hooks/use-focus-controller/index.mjs';\nimport { EVENT_CODE } from '../../../constants/aria.mjs';\nimport { isFunction } from '@vue/shared';\nimport { UPDATE_MODEL_EVENT } from '../../../constants/event.mjs';\nvar __default__ = defineComponent({\n  name: \"ElMention\",\n  inheritAttrs: false\n});\nvar _sfc_main = /* @__PURE__ */defineComponent(_objectSpread(_objectSpread({}, __default__), {}, {\n  props: mentionProps,\n  emits: mentionEmits,\n  setup: function setup(__props, _ref) {\n    var expose = _ref.expose,\n      emit = _ref.emit;\n    var props = __props;\n    var passInputProps = computed(function () {\n      return pick(props, Object.keys(inputProps));\n    });\n    var ns = useNamespace(\"mention\");\n    var disabled = useFormDisabled();\n    var contentId = useId();\n    var elInputRef = ref();\n    var tooltipRef = ref();\n    var dropdownRef = ref();\n    var visible = ref(false);\n    var cursorStyle = ref();\n    var mentionCtx = ref();\n    var computedPlacement = computed(function () {\n      return props.showArrow ? props.placement : \"\".concat(props.placement, \"-start\");\n    });\n    var computedFallbackPlacements = computed(function () {\n      return props.showArrow ? [\"bottom\", \"top\"] : [\"bottom-start\", \"top-start\"];\n    });\n    var filteredOptions = computed(function () {\n      var filterOption = props.filterOption,\n        options = props.options;\n      if (!mentionCtx.value || !filterOption) return options;\n      return options.filter(function (option) {\n        return filterOption(mentionCtx.value.pattern, option);\n      });\n    });\n    var dropdownVisible = computed(function () {\n      return visible.value && (!!filteredOptions.value.length || props.loading);\n    });\n    var hoveringId = computed(function () {\n      var _a;\n      return \"\".concat(contentId.value, \"-\").concat((_a = dropdownRef.value) == null ? void 0 : _a.hoveringIndex);\n    });\n    var handleInputChange = function handleInputChange(value) {\n      emit(\"update:modelValue\", value);\n      syncAfterCursorMove();\n    };\n    var handleInputKeyDown = function handleInputKeyDown(event) {\n      var _a, _b, _c, _d;\n      if (!(\"code\" in event) || ((_a = elInputRef.value) == null ? void 0 : _a.isComposing)) return;\n      switch (event.code) {\n        case EVENT_CODE.left:\n        case EVENT_CODE.right:\n          syncAfterCursorMove();\n          break;\n        case EVENT_CODE.up:\n        case EVENT_CODE.down:\n          if (!visible.value) return;\n          event.preventDefault();\n          (_b = dropdownRef.value) == null ? void 0 : _b.navigateOptions(event.code === EVENT_CODE.up ? \"prev\" : \"next\");\n          break;\n        case EVENT_CODE.enter:\n        case EVENT_CODE.numpadEnter:\n          if (!visible.value) return;\n          event.preventDefault();\n          if ((_c = dropdownRef.value) == null ? void 0 : _c.hoverOption) {\n            (_d = dropdownRef.value) == null ? void 0 : _d.selectHoverOption();\n          } else {\n            visible.value = false;\n          }\n          break;\n        case EVENT_CODE.esc:\n          if (!visible.value) return;\n          event.preventDefault();\n          visible.value = false;\n          break;\n        case EVENT_CODE.backspace:\n          if (props.whole && mentionCtx.value) {\n            var _mentionCtx$value = mentionCtx.value,\n              splitIndex = _mentionCtx$value.splitIndex,\n              selectionEnd = _mentionCtx$value.selectionEnd,\n              pattern = _mentionCtx$value.pattern,\n              prefixIndex = _mentionCtx$value.prefixIndex,\n              prefix = _mentionCtx$value.prefix;\n            var inputEl = getInputEl();\n            if (!inputEl) return;\n            var inputValue = inputEl.value;\n            var matchOption = props.options.find(function (item) {\n              return item.value === pattern;\n            });\n            var isWhole = isFunction(props.checkIsWhole) ? props.checkIsWhole(pattern, prefix) : matchOption;\n            if (isWhole && splitIndex !== -1 && splitIndex + 1 === selectionEnd) {\n              event.preventDefault();\n              var newValue = inputValue.slice(0, prefixIndex) + inputValue.slice(splitIndex + 1);\n              emit(UPDATE_MODEL_EVENT, newValue);\n              var newSelectionEnd = prefixIndex;\n              nextTick(function () {\n                inputEl.selectionStart = newSelectionEnd;\n                inputEl.selectionEnd = newSelectionEnd;\n                syncDropdownVisible();\n              });\n            }\n          }\n      }\n    };\n    var _useFocusController = useFocusController(elInputRef, {\n        beforeFocus: function beforeFocus() {\n          return disabled.value;\n        },\n        afterFocus: function afterFocus() {\n          syncAfterCursorMove();\n        },\n        beforeBlur: function beforeBlur(event) {\n          var _a;\n          return (_a = tooltipRef.value) == null ? void 0 : _a.isFocusInsideContent(event);\n        },\n        afterBlur: function afterBlur() {\n          visible.value = false;\n        }\n      }),\n      wrapperRef = _useFocusController.wrapperRef;\n    var handleInputMouseDown = function handleInputMouseDown() {\n      syncAfterCursorMove();\n    };\n    var handleSelect = function handleSelect(item) {\n      if (!mentionCtx.value) return;\n      var inputEl = getInputEl();\n      if (!inputEl) return;\n      var inputValue = inputEl.value;\n      var split = props.split;\n      var newEndPart = inputValue.slice(mentionCtx.value.end);\n      var alreadySeparated = newEndPart.startsWith(split);\n      var newMiddlePart = \"\".concat(item.value).concat(alreadySeparated ? \"\" : split);\n      var newValue = inputValue.slice(0, mentionCtx.value.start) + newMiddlePart + newEndPart;\n      emit(UPDATE_MODEL_EVENT, newValue);\n      emit(\"select\", item, mentionCtx.value.prefix);\n      var newSelectionEnd = mentionCtx.value.start + newMiddlePart.length + (alreadySeparated ? 1 : 0);\n      nextTick(function () {\n        inputEl.selectionStart = newSelectionEnd;\n        inputEl.selectionEnd = newSelectionEnd;\n        inputEl.focus();\n        syncDropdownVisible();\n      });\n    };\n    var getInputEl = function getInputEl() {\n      var _a, _b;\n      return props.type === \"textarea\" ? (_a = elInputRef.value) == null ? void 0 : _a.textarea : (_b = elInputRef.value) == null ? void 0 : _b.input;\n    };\n    var syncAfterCursorMove = function syncAfterCursorMove() {\n      setTimeout(function () {\n        syncCursor();\n        syncDropdownVisible();\n        nextTick(function () {\n          var _a;\n          return (_a = tooltipRef.value) == null ? void 0 : _a.updatePopper();\n        });\n      }, 0);\n    };\n    var syncCursor = function syncCursor() {\n      var inputEl = getInputEl();\n      if (!inputEl) return;\n      var caretPosition = getCursorPosition(inputEl);\n      var inputRect = inputEl.getBoundingClientRect();\n      var elInputRect = elInputRef.value.$el.getBoundingClientRect();\n      cursorStyle.value = {\n        position: \"absolute\",\n        width: 0,\n        height: \"\".concat(caretPosition.height, \"px\"),\n        left: \"\".concat(caretPosition.left + inputRect.left - elInputRect.left, \"px\"),\n        top: \"\".concat(caretPosition.top + inputRect.top - elInputRect.top, \"px\")\n      };\n    };\n    var syncDropdownVisible = function syncDropdownVisible() {\n      var inputEl = getInputEl();\n      if (document.activeElement !== inputEl) {\n        visible.value = false;\n        return;\n      }\n      var prefix = props.prefix,\n        split = props.split;\n      mentionCtx.value = getMentionCtx(inputEl, prefix, split);\n      if (mentionCtx.value && mentionCtx.value.splitIndex === -1) {\n        visible.value = true;\n        emit(\"search\", mentionCtx.value.pattern, mentionCtx.value.prefix);\n        return;\n      }\n      visible.value = false;\n    };\n    expose({\n      input: elInputRef,\n      tooltip: tooltipRef,\n      dropdownVisible: dropdownVisible\n    });\n    return function (_ctx, _cache) {\n      return openBlock(), createElementBlock(\"div\", {\n        ref_key: \"wrapperRef\",\n        ref: wrapperRef,\n        \"class\": normalizeClass([unref(ns).b(), unref(ns).is(\"disabled\", unref(disabled))])\n      }, [createVNode(unref(ElInput), mergeProps(mergeProps(unref(passInputProps), _ctx.$attrs), {\n        ref_key: \"elInputRef\",\n        ref: elInputRef,\n        \"model-value\": _ctx.modelValue,\n        disabled: unref(disabled),\n        role: unref(dropdownVisible) ? \"combobox\" : void 0,\n        \"aria-activedescendant\": unref(dropdownVisible) ? unref(hoveringId) || \"\" : void 0,\n        \"aria-controls\": unref(dropdownVisible) ? unref(contentId) : void 0,\n        \"aria-expanded\": unref(dropdownVisible) || void 0,\n        \"aria-label\": _ctx.ariaLabel,\n        \"aria-autocomplete\": unref(dropdownVisible) ? \"none\" : void 0,\n        \"aria-haspopup\": unref(dropdownVisible) ? \"listbox\" : void 0,\n        onInput: handleInputChange,\n        onKeydown: handleInputKeyDown,\n        onMousedown: handleInputMouseDown\n      }), createSlots({\n        _: 2\n      }, [renderList(_ctx.$slots, function (_, name) {\n        return {\n          name: name,\n          fn: withCtx(function (slotProps) {\n            return [renderSlot(_ctx.$slots, name, normalizeProps(guardReactiveProps(slotProps)))];\n          })\n        };\n      })]), 1040, [\"model-value\", \"disabled\", \"role\", \"aria-activedescendant\", \"aria-controls\", \"aria-expanded\", \"aria-label\", \"aria-autocomplete\", \"aria-haspopup\"]), createVNode(unref(ElTooltip), {\n        ref_key: \"tooltipRef\",\n        ref: tooltipRef,\n        visible: unref(dropdownVisible),\n        \"popper-class\": [unref(ns).e(\"popper\"), _ctx.popperClass],\n        \"popper-options\": _ctx.popperOptions,\n        placement: unref(computedPlacement),\n        \"fallback-placements\": unref(computedFallbackPlacements),\n        effect: \"light\",\n        pure: \"\",\n        offset: _ctx.offset,\n        \"show-arrow\": _ctx.showArrow\n      }, {\n        \"default\": withCtx(function () {\n          return [createElementVNode(\"div\", {\n            style: normalizeStyle(cursorStyle.value)\n          }, null, 4)];\n        }),\n        content: withCtx(function () {\n          var _a;\n          return [createVNode(ElMentionDropdown, {\n            ref_key: \"dropdownRef\",\n            ref: dropdownRef,\n            options: unref(filteredOptions),\n            disabled: unref(disabled),\n            loading: _ctx.loading,\n            \"content-id\": unref(contentId),\n            \"aria-label\": _ctx.ariaLabel,\n            onSelect: handleSelect,\n            onClick: withModifiers((_a = elInputRef.value) == null ? void 0 : _a.focus, [\"stop\"])\n          }, createSlots({\n            _: 2\n          }, [renderList(_ctx.$slots, function (_, name) {\n            return {\n              name: name,\n              fn: withCtx(function (slotProps) {\n                return [renderSlot(_ctx.$slots, name, normalizeProps(guardReactiveProps(slotProps)))];\n              })\n            };\n          })]), 1032, [\"options\", \"disabled\", \"loading\", \"content-id\", \"aria-label\", \"onClick\"])];\n        }),\n        _: 3\n      }, 8, [\"visible\", \"popper-class\", \"popper-options\", \"placement\", \"fallback-placements\", \"offset\", \"show-arrow\"])], 2);\n    };\n  }\n}));\nvar Mention = /* @__PURE__ */_export_sfc(_sfc_main, [[\"__file\", \"mention.vue\"]]);\nexport { Mention as default };","map":{"version":3,"names":["name","inheritAttrs","passInputProps","computed","pick","props","Object","keys","inputProps","ns","useNamespace","disabled","useFormDisabled","contentId","useId","elInputRef","ref","tooltipRef","dropdownRef","visible","cursorStyle","mentionCtx","computedPlacement","showArrow","placement","concat","computedFallbackPlacements","filteredOptions","filterOption","options","value","filter","option","pattern","dropdownVisible","length","loading","hoveringId","_a","hoveringIndex","handleInputChange","emit","syncAfterCursorMove","handleInputKeyDown","event","_b","_c","_d","isComposing","code","EVENT_CODE","left","right","up","down","preventDefault","navigateOptions","enter","numpadEnter","hoverOption","selectHoverOption","esc","backspace","whole","_mentionCtx$value","splitIndex","selectionEnd","prefixIndex","prefix","inputEl","getInputEl","inputValue","matchOption","find","item","isWhole","isFunction","checkIsWhole","newValue","slice","UPDATE_MODEL_EVENT","newSelectionEnd","nextTick","selectionStart","syncDropdownVisible","_useFocusController","useFocusController","beforeFocus","afterFocus","beforeBlur","isFocusInsideContent","afterBlur","wrapperRef","handleInputMouseDown","handleSelect","split","newEndPart","end","alreadySeparated","startsWith","newMiddlePart","start","focus","type","textarea","input","setTimeout","syncCursor","updatePopper","caretPosition","getCursorPosition","inputRect","getBoundingClientRect","elInputRect","$el","position","width","height","top","document","activeElement","getMentionCtx"],"sources":["../../../../../../packages/components/mention/src/mention.vue"],"sourcesContent":["<template>\n  <div ref=\"wrapperRef\" :class=\"[ns.b(), ns.is('disabled', disabled)]\">\n    <el-input\n      v-bind=\"mergeProps(passInputProps, $attrs)\"\n      ref=\"elInputRef\"\n      :model-value=\"modelValue\"\n      :disabled=\"disabled\"\n      :role=\"dropdownVisible ? 'combobox' : undefined\"\n      :aria-activedescendant=\"dropdownVisible ? hoveringId || '' : undefined\"\n      :aria-controls=\"dropdownVisible ? contentId : undefined\"\n      :aria-expanded=\"dropdownVisible || undefined\"\n      :aria-label=\"ariaLabel\"\n      :aria-autocomplete=\"dropdownVisible ? 'none' : undefined\"\n      :aria-haspopup=\"dropdownVisible ? 'listbox' : undefined\"\n      @input=\"handleInputChange\"\n      @keydown=\"handleInputKeyDown\"\n      @mousedown=\"handleInputMouseDown\"\n    >\n      <template v-for=\"(_, name) in $slots\" #[name]=\"slotProps\">\n        <slot :name=\"name\" v-bind=\"slotProps\" />\n      </template>\n    </el-input>\n    <el-tooltip\n      ref=\"tooltipRef\"\n      :visible=\"dropdownVisible\"\n      :popper-class=\"[ns.e('popper'), popperClass]\"\n      :popper-options=\"popperOptions\"\n      :placement=\"computedPlacement\"\n      :fallback-placements=\"computedFallbackPlacements\"\n      effect=\"light\"\n      pure\n      :offset=\"offset\"\n      :show-arrow=\"showArrow\"\n    >\n      <template #default>\n        <div :style=\"cursorStyle\" />\n      </template>\n      <template #content>\n        <el-mention-dropdown\n          ref=\"dropdownRef\"\n          :options=\"filteredOptions\"\n          :disabled=\"disabled\"\n          :loading=\"loading\"\n          :content-id=\"contentId\"\n          :aria-label=\"ariaLabel\"\n          @select=\"handleSelect\"\n          @click.stop=\"elInputRef?.focus\"\n        >\n          <template v-for=\"(_, name) in $slots\" #[name]=\"slotProps\">\n            <slot :name=\"name\" v-bind=\"slotProps\" />\n          </template>\n        </el-mention-dropdown>\n      </template>\n    </el-tooltip>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { computed, mergeProps, nextTick, ref } from 'vue'\nimport { pick } from 'lodash-unified'\nimport { useFocusController, useId, useNamespace } from '@element-plus/hooks'\nimport ElInput, { inputProps } from '@element-plus/components/input'\nimport ElTooltip from '@element-plus/components/tooltip'\nimport { EVENT_CODE, UPDATE_MODEL_EVENT } from '@element-plus/constants'\nimport { useFormDisabled } from '@element-plus/components/form'\nimport { isFunction } from '@element-plus/utils'\nimport { mentionEmits, mentionProps } from './mention'\nimport { getCursorPosition, getMentionCtx } from './helper'\nimport ElMentionDropdown from './mention-dropdown.vue'\n\nimport type { Placement } from '@popperjs/core'\nimport type { CSSProperties, ComputedRef, Ref } from 'vue'\nimport type { InputInstance } from '@element-plus/components/input'\nimport type { TooltipInstance } from '@element-plus/components/tooltip'\nimport type { MentionCtx, MentionOption } from './types'\n\ndefineOptions({\n  name: 'ElMention',\n  inheritAttrs: false,\n})\n\nconst props = defineProps(mentionProps)\nconst emit = defineEmits(mentionEmits)\n\nconst passInputProps = computed(() => pick(props, Object.keys(inputProps)))\n\nconst ns = useNamespace('mention')\nconst disabled = useFormDisabled()\nconst contentId = useId()\n\nconst elInputRef = ref<InputInstance>()\nconst tooltipRef = ref<TooltipInstance>()\nconst dropdownRef = ref<InstanceType<typeof ElMentionDropdown>>()\n\nconst visible = ref(false)\nconst cursorStyle = ref<CSSProperties>()\nconst mentionCtx = ref<MentionCtx>()\n\nconst computedPlacement = computed<Placement>(() =>\n  props.showArrow ? props.placement : `${props.placement}-start`\n)\n\nconst computedFallbackPlacements = computed<Placement[]>(() =>\n  props.showArrow ? ['bottom', 'top'] : ['bottom-start', 'top-start']\n)\n\nconst filteredOptions = computed(() => {\n  const { filterOption, options } = props\n  if (!mentionCtx.value || !filterOption) return options\n  return options.filter((option) =>\n    filterOption(mentionCtx.value!.pattern, option)\n  )\n})\n\nconst dropdownVisible = computed(() => {\n  return visible.value && (!!filteredOptions.value.length || props.loading)\n})\n\nconst hoveringId = computed(() => {\n  return `${contentId.value}-${dropdownRef.value?.hoveringIndex}`\n})\n\nconst handleInputChange = (value: string) => {\n  emit('update:modelValue', value)\n  syncAfterCursorMove()\n}\n\nconst handleInputKeyDown = (event: KeyboardEvent | Event) => {\n  if (!('code' in event) || elInputRef.value?.isComposing) return\n\n  switch (event.code) {\n    case EVENT_CODE.left:\n    case EVENT_CODE.right:\n      syncAfterCursorMove()\n      break\n    case EVENT_CODE.up:\n    case EVENT_CODE.down:\n      if (!visible.value) return\n      event.preventDefault()\n      dropdownRef.value?.navigateOptions(\n        event.code === EVENT_CODE.up ? 'prev' : 'next'\n      )\n      break\n    case EVENT_CODE.enter:\n    case EVENT_CODE.numpadEnter:\n      if (!visible.value) return\n      event.preventDefault()\n      if (dropdownRef.value?.hoverOption) {\n        dropdownRef.value?.selectHoverOption()\n      } else {\n        visible.value = false\n      }\n      break\n    case EVENT_CODE.esc:\n      if (!visible.value) return\n      event.preventDefault()\n      visible.value = false\n      break\n    case EVENT_CODE.backspace:\n      if (props.whole && mentionCtx.value) {\n        const { splitIndex, selectionEnd, pattern, prefixIndex, prefix } =\n          mentionCtx.value\n        const inputEl = getInputEl()\n        if (!inputEl) return\n        const inputValue = inputEl.value\n        const matchOption = props.options.find((item) => item.value === pattern)\n        const isWhole = isFunction(props.checkIsWhole)\n          ? props.checkIsWhole(pattern, prefix)\n          : matchOption\n        if (isWhole && splitIndex !== -1 && splitIndex + 1 === selectionEnd) {\n          event.preventDefault()\n          const newValue =\n            inputValue.slice(0, prefixIndex) + inputValue.slice(splitIndex + 1)\n          emit(UPDATE_MODEL_EVENT, newValue)\n\n          const newSelectionEnd = prefixIndex\n          nextTick(() => {\n            // input value is updated\n            inputEl.selectionStart = newSelectionEnd\n            inputEl.selectionEnd = newSelectionEnd\n            syncDropdownVisible()\n          })\n        }\n      }\n  }\n}\n\nconst { wrapperRef } = useFocusController(elInputRef, {\n  beforeFocus() {\n    return disabled.value\n  },\n  afterFocus() {\n    syncAfterCursorMove()\n  },\n  beforeBlur(event) {\n    return tooltipRef.value?.isFocusInsideContent(event)\n  },\n  afterBlur() {\n    visible.value = false\n  },\n})\n\nconst handleInputMouseDown = () => {\n  syncAfterCursorMove()\n}\n\nconst handleSelect = (item: MentionOption) => {\n  if (!mentionCtx.value) return\n  const inputEl = getInputEl()\n  if (!inputEl) return\n  const inputValue = inputEl.value\n  const { split } = props\n\n  const newEndPart = inputValue.slice(mentionCtx.value.end)\n  const alreadySeparated = newEndPart.startsWith(split)\n  const newMiddlePart = `${item.value}${alreadySeparated ? '' : split}`\n\n  const newValue =\n    inputValue.slice(0, mentionCtx.value.start) + newMiddlePart + newEndPart\n\n  emit(UPDATE_MODEL_EVENT, newValue)\n  emit('select', item, mentionCtx.value.prefix)\n\n  const newSelectionEnd =\n    mentionCtx.value.start + newMiddlePart.length + (alreadySeparated ? 1 : 0)\n\n  nextTick(() => {\n    // input value is updated\n    inputEl.selectionStart = newSelectionEnd\n    inputEl.selectionEnd = newSelectionEnd\n    inputEl.focus()\n    syncDropdownVisible()\n  })\n}\n\nconst getInputEl = () =>\n  props.type === 'textarea'\n    ? elInputRef.value?.textarea\n    : elInputRef.value?.input\n\nconst syncAfterCursorMove = () => {\n  // can't use nextTick(), get cursor position will be wrong\n  setTimeout(() => {\n    syncCursor()\n    syncDropdownVisible()\n    nextTick(() => tooltipRef.value?.updatePopper())\n  }, 0)\n}\n\nconst syncCursor = () => {\n  const inputEl = getInputEl()\n  if (!inputEl) return\n\n  const caretPosition = getCursorPosition(inputEl)\n  const inputRect = inputEl.getBoundingClientRect()\n  const elInputRect = elInputRef.value!.$el.getBoundingClientRect()\n\n  cursorStyle.value = {\n    position: 'absolute',\n    width: 0,\n    height: `${caretPosition.height}px`,\n    left: `${caretPosition.left + inputRect.left - elInputRect.left}px`,\n    top: `${caretPosition.top + inputRect.top - elInputRect.top}px`,\n  }\n}\n\nconst syncDropdownVisible = () => {\n  const inputEl = getInputEl()\n  if (document.activeElement !== inputEl) {\n    visible.value = false\n    return\n  }\n  const { prefix, split } = props\n  mentionCtx.value = getMentionCtx(inputEl, prefix, split)\n  if (mentionCtx.value && mentionCtx.value.splitIndex === -1) {\n    visible.value = true\n    emit('search', mentionCtx.value.pattern, mentionCtx.value.prefix)\n    return\n  }\n  visible.value = false\n}\n\ndefineExpose<{\n  input: Ref<InputInstance | undefined>\n  tooltip: Ref<TooltipInstance | undefined>\n  dropdownVisible: ComputedRef<boolean>\n}>({\n  input: elInputRef,\n  tooltip: tooltipRef,\n  dropdownVisible,\n})\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}